{"version":3,"sources":["@stdlib/utils/async/series-waterfall/lib/factory.js","@stdlib/utils/async/series-waterfall/lib/waterfall.js","@stdlib/utils/async/series-waterfall/lib/index.js"],"names":["isFunctionArray","__var_0__","isFunction","__var_1__","factory","fcns","clbk","thisArg","TypeError","idx","next","args","len","i","arguments","length","Array","apply","waterfall","setReadOnly","__var_2__"],"mappings":"+JAuBA,IAAIA,EAAkBC,EAClBC,EAAaC,EAyCjB,SAASC,EAASC,EAAMC,EAAMC,GAC7B,IAAMP,EAAiBK,GACtB,MAAM,IAAIG,UAAW,sEAAwEH,EAAO,MAErG,IAAMH,EAAYI,GACjB,MAAM,IAAIE,UAAW,iEAAmEF,EAAO,MAEhG,OAOA,WACC,IAAIG,GAAO,GAWX,SAASC,IACR,IAAIC,EACAC,EACAC,EAGJ,GAAKC,UAAW,GACf,OAAOR,EAAMQ,UAAW,IAIzB,IADAL,GAAO,IACKJ,EAAKU,OAChB,OAAOT,IAKR,IAFAM,EAAME,UAAUC,OAChBJ,EAAO,IAAIK,MAAOJ,GACZC,EAAI,EAAGA,EAAID,EAAI,EAAGC,IACvBF,EAAME,GAAMC,UAAWD,EAAE,GAG1BF,EAAME,GAAMH,EAGZL,EAAMI,GAAMQ,MAAOV,EAASI,GAlC7BD,IC3DF,IAAIN,EAAUH,EAoCd,SAASiB,EAAWb,EAAMC,EAAMC,GAC/BH,EAASC,EAAMC,EAAMC,EAArBH,GCLD,IAAIe,EAAclB,EACdiB,EAAYf,EACZC,EAAUgB,EAKdD,EAAaD,EAAW,UAAWd","sourcesContent":["import __var_0__ from '@stdlib/assert/is-function-array';\nimport __var_1__ from '@stdlib/assert/is-function';\n/**\n\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\nvar isFunctionArray = __var_0__;\nvar isFunction = __var_1__;\n\n\n// MAIN //\n\n/**\n* Returns a reusable waterfall function.\n*\n* @param {FunctionArray} fcns - array of functions\n* @param {Callback} clbk - callback to invoke upon completion\n* @param {*} [thisArg] - function context\n* @throws {TypeError} first argument must be an array of functions\n* @throws {TypeError} second argument must be a function\n* @returns {Function} waterfall function\n*\n* @example\n* function foo( next ) {\n*     next( null, 'beep' );\n* }\n*\n* function bar( str, next ) {\n*     console.log( str );\n*     // => 'beep'\n*\n*     next();\n* }\n*\n* function done( error ) {\n*     if ( error ) {\n*         throw error;\n*     }\n* }\n*\n* var fcns = [ foo, bar ];\n*\n* var waterfall = factory( fcns, done );\n*\n* waterfall();\n* waterfall();\n* waterfall();\n*/\nfunction factory( fcns, clbk, thisArg ) {\n\tif ( !isFunctionArray( fcns ) ) {\n\t\tthrow new TypeError( 'invalid argument. First argument must be a function array. Value: `' + fcns + '`.' );\n\t}\n\tif ( !isFunction( clbk ) ) {\n\t\tthrow new TypeError( 'invalid argument. Second argument must be a function. Value: `' + clbk + '`.' );\n\t}\n\treturn waterfall;\n\n\t/**\n\t* Executes functions in series, passing the results of one function as arguments to the next function.\n\t*\n\t* @private\n\t*/\n\tfunction waterfall() {\n\t\tvar idx = -1;\n\t\tnext(); // eslint-disable-line callback-return\n\n\t\t/**\n\t\t* Executes the next function in the series.\n\t\t*\n\t\t* @private\n\t\t* @param {(Error|null)} error - error object\n\t\t* @param {...*} args - results to pass to next callback\n\t\t* @returns {void}\n\t\t*/\n\t\tfunction next() {\n\t\t\tvar args;\n\t\t\tvar len;\n\t\t\tvar i;\n\n\t\t\t// Check for an error...\n\t\t\tif ( arguments[ 0 ] ) {\n\t\t\t\treturn clbk( arguments[ 0 ] );\n\t\t\t}\n\t\t\t// Update the counter and check if we have run all functions...\n\t\t\tidx += 1;\n\t\t\tif ( idx >= fcns.length ) {\n\t\t\t\treturn clbk();\n\t\t\t}\n\t\t\t// Copy the remaining arguments...\n\t\t\tlen = arguments.length;\n\t\t\targs = new Array( len );\n\t\t\tfor ( i = 0; i < len-1; i++ ) {\n\t\t\t\targs[ i ] = arguments[ i+1 ];\n\t\t\t}\n\t\t\t// Add the callback:\n\t\t\targs[ i ] = next;\n\n\t\t\t// Apply the arguments to the next function in the waterfall:\n\t\t\tfcns[ idx ].apply( thisArg, args );\n\t\t}\n\t}\n}\n\n\n// EXPORTS //\nexport default factory;\n","import __var_0__ from './factory.js';\n/**\n\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\nvar factory = __var_0__;\n\n\n// MAIN //\n\n/**\n* Executes functions in series, passing the results of one function as arguments to the next function.\n*\n* @param {FunctionArray} fcns - array of functions\n* @param {Callback} clbk - callback to invoke upon completion\n* @param {*} [thisArg] - function context\n* @throws {TypeError} first argument must be an array of functions\n* @throws {TypeError} second argument must be a function\n*\n* @example\n* function foo( next ) {\n*     next( null, 'beep' );\n* }\n*\n* function bar( str, next ) {\n*     console.log( str );\n*     // => 'beep'\n*\n*     next();\n* }\n*\n* function done( error ) {\n*     if ( error ) {\n*         throw error;\n*     }\n* }\n*\n* var fcns = [ foo, bar ];\n*\n* waterfall( fcns, done );\n*/\nfunction waterfall( fcns, clbk, thisArg ) {\n\tfactory( fcns, clbk, thisArg )();\n}\n\n\n// EXPORTS //\nexport default waterfall;\n","import __var_0__ from '@stdlib/utils/define-nonenumerable-read-only-property';\nimport __var_1__ from './waterfall.js';\nimport __var_2__ from './factory.js';\n/**\n\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n/**\n* Execute functions in series, passing the results of one function as arguments to the next function.\n*\n* @module @stdlib/utils/async/series-waterfall\n*\n* @example\n* var waterfall = require( '@stdlib/utils/async/series-waterfall' );\n*\n* function foo( next ) {\n*     next( null, 'beep' );\n* }\n*\n* function bar( str, next ) {\n*     console.log( str );\n*     // => 'beep'\n*\n*     next();\n* }\n*\n* function done( error ) {\n*     if ( error ) {\n*         throw error;\n*     }\n* }\n*\n* var fcns = [ foo, bar ];\n*\n* waterfall( fcns, done );\n*/\n\n// MODULES //\nvar setReadOnly = __var_0__;\nvar waterfall = __var_1__;\nvar factory = __var_2__;\n\n\n// MAIN //\n\nsetReadOnly( waterfall, 'factory', factory );\n\n\n// EXPORTS //\nexport default waterfall;\n"]}