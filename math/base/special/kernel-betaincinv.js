// This file is a part of stdlib. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
import r from"./../tools/evalpoly.js";import t from"./betainc.js";import n from"./expm1.js";import o from"./log1p.js";import e from"./asin.js";import i from"./beta.js";import f from"./sqrt.js";import u from"./abs.js";import a from"./exp.js";import m from"./pow.js";import s from"./sin.js";import c from"./max.js";import p from"./min.js";import l from"./ln.js";import v from"./../../../constants/math/float64-smallest-normal.js";import j from"./../../../constants/math/float64-half-pi.js";import b from"./../../../constants/math/float64-eps.js";import h from"./erfcinv.js";import k from"./floor.js";import d from"./ldexp.js";import w from"./round.js";import x from"./acos.js";import g from"./cos.js";import q from"./../../../constants/math/float64-sqrt-two.js";import y from"./../../../constants/math/float64-pi.js";import z from"./gamma-delta-ratio.js";import A from"./../../../constants/math/float64-max.js";import B from"./signum.js";import C from"./gammaincinv.js";import D from"./../../../constants/math/float64-smallest-subnormal.js";import E from"./kernel-betainc.js";function F(r){return 0===r?.16666666666666666:.16666666666666666+.16666666666666666*r}function G(r){return 0===r?.058333333333333334:.058333333333333334+r*(.06666666666666667+.008333333333333333*r)}function H(r){return 0===r?.0251984126984127:.0251984126984127+r*(.026785714285714284+r*(.0017857142857142857+.0001984126984126984*r))}function I(r){return 0===r?.012039792768959435:.012039792768959435+r*(.010559964726631394+r*(r*(.0003747795414462081+27557319223985893e-22*r)-.0011078042328042327))}function J(r){return 0===r?.003837005972422639:.003837005972422639+r*(.00610392115600449+r*(r*(.0005945867404200738+r*(2.505210838544172e-8*r-6270542728876062e-20))-.0016095979637646305))}function K(r){return 0===r?.0032177478835464946:.0032177478835464946+r*(.0010898206731540065+r*(r*(.0006908420797309686+r*(r*(154012654012654e-19+1.6059043836821613e-10*r)-.00016376804137220805))-.0012579159844784845))}function L(r){return 0===r?.001743826229834001:.001743826229834001+r*(3353097688001788e-20+r*(r*(.0006451304695145635+r*(r*(49255746366361444e-21+r*(7647163731819816e-28*r-39851014346715405e-22))-.000249472580470431))-.0007624513544032393))}function M(r){return 0===r?.0009647274732138864:.0009647274732138864+r*(r*(r*(.0005140660578834113+r*(r*(9086710793521991e-20+r*(r*(10914179173496788e-22+28114572543455206e-31*r)-15303004486655377e-21))-.00029133414466938067))-.00036307660358786886)-.0003110108632631878)}function N(r){return 0===r?.0005422926281312969:.0005422926281312969+r*(r*(r*(.00035764655430568635+r*(r*(.00012645437628698076+r*(r*(4890304529197534e-21+r*(822063524662433e-32*r-3.123956959982987e-7))-33202652391372056e-21))-.00028690924218514614))-.00010230378073700413)-.0003694266780000966)}var O=z,P=r,Q=f,R=y,S=F,T=G,U=H,V=I,W=J,X=K,Y=L,Z=M,$=N,_=0,rr=[1,0,0,0,0,0,0,0,0,0];function tr(r,t){var n,o;return o=O(r/2,.5)*Q(r*R)*(t-.5),n=1/r,rr[1]=S(n),rr[2]=T(n),rr[3]=U(n),rr[4]=V(n),rr[5]=W(n),rr[6]=X(n),rr[7]=Y(n),rr[8]=Z(n),rr[9]=$(n),_+o*P(rr,o*o)}var nr=z,or=r,er=f,ir=m,fr=y,ur=[0,0,0,0,0,0,0];function ar(r,t){var n,o,e,i,f,u,a;return a=nr(r/2,.5)*er(r*fr)*t,e=r+2,i=r+4,f=r+6,ur[0]=1,ur[1]=-(r+1)/(2*e),e*=r+2,ur[2]=-r*(r+1)*(r+3)/(8*e*i),e*=r+2,ur[3]=-r*(r+1)*(r+5)*((3*r+7)*r-2)/(48*e*i*f),e*=r+2,i*=r+4,ur[4]=-r*(r+1)*(r+7)*(((((15*r+154)*r+465)*r+286)*r-336)*r+64)/(384*e*i*f*(r+8)),e*=r+2,ur[5]=-r*(r+1)*(r+3)*(r+9)*((((((35*r+452)*r+1573)*r+600)*r-2020)*r+928)*r-128)/(1280*e*i*f*(r+8)*(r+10)),e*=r+2,i*=r+4,f*=r+6,ur[6]=-r*(r+1)*(r+11)*(((((((((((945*r+31506)*r+425858)*r+2980236)*r+11266745)*r+20675018)*r+7747124)*r-22574632)*r-8565600)*r+18108416)*r-7099392)*r+884736)/(46080*e*i*f*(r+8)*(r+10)*(r+12)),u=er(r),o=ir(u*a,1/r),n=or(ur,o*o),n*=u,-(n/=o)}var mr=h,sr=n,cr=f,pr=m,lr=j,vr=q;function jr(r,t){var n,o,e,i,f,u;return r>1e20?-mr(2*t)*vr:(i=((94.5/((o=48/((n=1/(r-.5))*n))+(e=((20700*n/o-98)*n-16)*n+96.36))-3)/o+1)*cr(n*lr)*r,(u=pr(2*i*t,2/r))>.05+n?(f=-mr(2*t)*vr,r<5&&(e+=.3*(r-4.5)*(f+.6)),u=sr(n*(u=(((((.4*(u=f*f)+6.3)*u+36)*u+94.5)/(e+=(((.05*i*f-5)*f-7)*f-2)*f+o)-u-3)/o+1)*f)*u)):u=((1/(((r+6)/(r*u)-.089*i-.822)*(r+2)*3)+.5/(r+4))*u-1)*(r+1)/(r+2)+1/u,-cr(r*u))}var br=h,hr=k,kr=d,dr=w,wr=x,xr=f,gr=u,qr=g,yr=m,zr=s,Ar=q,Br=y,Cr=tr,Dr=ar,Er=jr,Fr=268435456,Gr=1/3,Hr=106/3,Ir=.8549879733383485;function Jr(r,t,n){var o,e,i,f,u,a,m,s,c,p,l,v,j;if(f=0,t>n?(u=n,n=t,t=u,i=!0):i=!1,hr(r)===r&&r<20)switch(o=kr(1,Hr),hr(r)){case 1:f=.5===t?0:-qr(Br*t)/zr(Br*t);break;case 2:f=(2*t-1)/xr(2*t*n);break;case 4:e=xr(4*t*n),p=4*qr(wr(e)/3)/e,l=xr(p-4),f=t-.5<0?-l:l;break;case 6:if(t<1e-150)return(i?-1:1)*Er(r,t);j=yr(v=4*(t-t*t),Gr),c=6*(1+Ir*(1/j-1));do{a=c,c=2*(8*v*(c*(s=(m=c*c)*m))-270*m+2187)/(5*(4*v*s-216*c-243))}while(gr((c-a)/c)>o);c=xr(c-r),f=t-.5<0?-c:c;break;default:f=r>Fr?br(2*t)*Ar:r<3?t>.2742-.0242143*r?Cr(r,t):Dr(r,t):t>kr(1,dr(r/-.654))?Er(r,t):Dr(r,t)}else f=r>Fr?-br(2*t)*Ar:r<3?t>.2742-.0242143*r?Cr(r,t):Dr(r,t):t>kr(1,dr(r/-.654))?Er(r,t):Dr(r,t);return i?-f:f}var Kr=Jr;function Lr(r,t,n){var o,e,i;return i=Kr(o=2*r,e=t/2,1-e),n&&(n.value=i*i/(o+i*i)),o/(o+i*i)}var Mr=r,Nr=h,Or=f,Pr=a,Qr=q,Rr=[0,0,0,0,0,0,0],Sr=[0,0,0,0];function Tr(r,t,n){var o,e,i,f,u,a,m;return o=Nr(2*n),o/=-Or(r/2),Sr[0]=o,u=(f=(a=t-r)*a)*a,Rr[0]=-a*Qr/2,Rr[1]=(1-2*a)/8,Rr[2]=-a*Qr/48,Rr[3]=-1/192,Rr[4]=-a*Qr/3840,Rr[5]=0,Rr[6]=0,Sr[1]=Mr(Rr,o),Rr[0]=a*Qr*(3*a-2)/12,Rr[1]=(20*f-12*a+1)/128,Rr[2]=a*Qr*(20*a-1)/960,Rr[3]=(16*f+30*a-15)/4608,Rr[4]=a*Qr*(21*a+32)/53760,Rr[5]=(-32*f+63)/368640,Rr[6]=-a*Qr*(120*a+17)/25804480,Sr[2]=Mr(Rr,o),Rr[0]=a*Qr*(-75*f+80*a-16)/480,Rr[1]=(-1080*u+868*f-90*a-45)/9216,Rr[2]=a*Qr*(-1190*f+84*a+373)/53760,Rr[3]=(-2240*u-2508*f+2100*a-165)/368640,Rr[4]=0,Rr[5]=0,Rr[6]=0,Sr[3]=Mr(Rr,o),i=Mr(Sr,1/r),m=-Pr(-(e=i*i)/2),0===e?.5:(1+i*Or((1+m)/e))/2}var Ur=l,Vr=A,Wr=Vr/4;function Xr(r,t){return function(n){var o;if(0===(o=1-n))return[-Wr,-Wr];if(0===n)return[-Wr,-Wr];return[Ur(n)+t*Ur(o)+r,1/n-t/o]}}var Yr=B,Zr=u,$r=d,_r=A;function rt(r,t,n,o,e,i){var f,u,a,m,s,c,p,l,v,j;v=0,f=0,s=t,m=$r(1,1-e),p=_r,u=_r,a=_r,c=i;do{if(f=v,a=u,u=p,v=(l=r(s))[0],j=l[1],c-=1,0===v)break;if(0===j?(0===f&&(f=r(t=s===n?o:n),p=t-s),p=Yr(f)*Yr(v)<0?p<0?(s-n)/2:(s-o)/2:p<0?(s-o)/2:(s-n)/2):p=v/j,Zr(2*p)>Zr(a)&&(p=p>0?(s-n)/2:(s-o)/2),t=s,(s-=p)<=n){if((s=t-(p=.5*(t-n)))===n||s===o)break}else if(s>=o&&((s=t-(p=.5*(t-o)))===n||s===o))break;p>0?o=t:n=t}while(c&&Zr(s*m)<Zr(p));return s}function tt(r){return 0===r?-1:r*(5*r-5)-1}function nt(r){return 0===r?1:1+r*(21+r*(46*r-69))}function ot(r){return 0===r?7:7+r*(r*(33+r*(31*r-62))-2)}function et(r){return 0===r?25:25+r*(r*(r*(88+r*(46*r-115))-17)-52)}function it(r){return 0===r?7:7+r*(12+r*(52*r-78))}function ft(r){return 0===r?-7:r*(2+r*(183+r*(185*r-370)))-7}function ut(r){return 0===r?-533:r*(776+r*(r*(10240+r*(5410*r-13525))-1835))-533}function at(r){return 0===r?-1579:r*(3747+r*(r*(r*(45588+r*(15071*r-45213))-15821)-3372))-1579}function mt(r){return 0===r?449:449+r*(r*(r*(6686+r*(3704*r-9260))-769)-1259)}function st(r){return 0===r?63149:63149+r*(r*(140052+r*(r*(2239932+r*(750479*r-2251437))-727469))-151557)}function ct(r){return 0===r?29233:29233+r*(r*(105222+r*(146879+r*(r*(3195183+r*(729754*r-2554139))-1602610)))-78755)}function pt(r){return 0===r?1:1+r*(13*r-13)}function lt(r){return 0===r?1:1+r*(21+r*(46*r-69))}var vt=r,jt=h,bt=u,ht=a,kt=l,dt=f,wt=s,xt=g,gt=Xr,qt=rt,yt=tt,zt=nt,At=ot,Bt=et,Ct=it,Dt=ft,Et=ut,Ft=at,Gt=mt,Ht=st,It=ct,Jt=pt,Kt=lt,Lt=[0,0,0,0,0,0],Mt=[0,0,0,0];function Nt(r,t,n){var o,e,i,f,u,a,m,s,c,p,l,v,j,b,h,k,d,w,x,g;return u=jt(2*r)/-dt(t/2),w=wt(n),d=xt(n),Mt[0]=u,h=w*w,k=d*d,c=(v=(j=w*d)*j)*(l=v*j),s=l*l,m=(p=v*v)*l,Lt[0]=(2*h-1)/(3*j),Lt[1]=-yt(h)/(36*v),Lt[2]=zt(h)/(1620*l),Lt[3]=At(h)/(6480*p),Lt[4]=Bt(h)/(90720*c),Lt[5]=0,Mt[1]=vt(Lt,u),Lt[0]=-Ct(h)/(405*l),Lt[1]=Dt(h)/(2592*p),Lt[2]=-Et(h)/(204120*c),Lt[3]=-Ft(h)/(2099520*s),Lt[4]=0,Lt[5]=0,Mt[2]=vt(Lt,u),Lt[0]=Gt(h)/(102060*c),Lt[1]=-Ht(h)/(20995200*s),Lt[2]=It(h)/(36741600*m),Lt[3]=0,Lt[4]=0,Lt[5]=0,Mt[3]=vt(Lt,u),i=d/w,i*=i,b=-(a=vt(Mt,1/t))*a/(2*h)+kt(h)+k*kt(k)/h,bt(a)<.7?(Lt[0]=h,Lt[1]=j,Lt[2]=(1-2*h)/3,Lt[3]=Jt(h)/(36*j),Lt[4]=Kt(h)/(270*v),Lt[5]=0,g=vt(Lt,a)):(x=ht(b),Lt[0]=x,Lt[1]=i,Lt[2]=0,Lt[3]=3*i*(3*i+1)/6,Lt[4]=4*i*(4*i+1)*(4*i+2)/24,Lt[5]=5*i*(5*i+1)*(5*i+2)*(5*i+3)/120,((g=vt(Lt,x))-h)*a<0&&(g=1-g)),a<0?(e=0,o=h):(e=h,o=1),(g<e||g>o)&&(g=(e+o)/2),f=gt(-b,i),g=qt(f,g,e,o,32,100)}var Ot=C,Pt=l,Qt=f,Rt=D,St=Xr,Tt=rt;function Ut(r,t,n,o){var e,i,f,u,a,m,s,c,p,l,v,j,b,h,k,d,w,x,g,q,y,z,A,B,C,D,E,F;return a=n<o?Ot(n,t,!0):Ot(o,t,!1),a/=r,l=((D=Qt(1+(b=t/r)))+2)*(D-1)/(3*D),l+=((w=(d=D*D)*D)+9*d+21*D+5)*(C=a-b)/(36*d*(B=D+1)),l-=((x=d*d)-13*w+69*d+167*D+46)*(h=C*C)/(1620*(s=B*B)*w),l-=(7*(g=w*d)+21*x+70*w+26*d-93*D-31)*(k=h*C)/(6480*(c=B*s)*x),v=(28*x+131*w+402*d+581*D+208)*(D-1)/(1620*B*w),v-=(35*(q=w*w)-154*g-623*x-1636*w-3983*d-3514*D-925)*C/(12960*s*x),v-=(2132*(y=x*w)+7915*q+16821*g+35066*x+87490*w+141183*d+95993*D+21640)*h/(816480*g*c),j=-(3592*y+8375*q-1323*g-29198*x-89578*w-154413*d-116063*D-29632)*(D-1)/(816480*g*s),j-=(442043*(A=g*x)+2054169*(z=x*x)+3803094*y+3470754*q+2141568*g-2393568*x-19904934*w-34714674*d-23128299*D-5253353)*C/(146966400*q*c),(m=a+(l-=(75*q+202*g+188*x-888*w-1345*d+118*D+138)*(h*h)/(272160*(p=s*s)*g))/r+(v-=(11053*z+53308*y+117010*q+163924*g+116188*x-258428*w-677042*d-481940*D-105497)*k/(14696640*p*q))/(r*r)+(j-=(116932*(g*g)+819281*A+2378172*z+4341330*y+6806004*q+10622748*g+18739500*x+30651894*w+30869976*d+15431867*D+2919016)*h/(146966400*p*y))/(r*r*r))<=0&&(m=Rt),E=m-b*Pt(m)+(1+b)*Pt(1+b)-b,e=1/(1+b),F=((f=m<b?e:0)+(u=m<b?1:e))/2,i=St(E,b),Tt(i,F,f,u,32,100)}var Vt=u,Wt=d,Xt=B,Yt=c,Zt=A;function $t(r,t,n,o,e,i){var f,u,a,m,s,c,p,l,v,j,b,h,k,d,w,x;d=0,u=!1,c=t,s=Wt(1,1-e),p=0,a=v=Yt(1e7*t,1e7),m=v,l=i;do{if(p=d,m=a,a=v,d=(k=r(c))[0],w=k[1],x=k[2],l-=1,0===d)break;if(0===w?(0===p&&(p=r(t=c===n?o:n),v=t-c),v=Xt(p)*Xt(d)<0?v<0?(c-n)/2:(c-o)/2:v<0?(c-o)/2:(c-n)/2):0===x?v=d/w:(j=2*d,(v=Vt(h=2*w-d*(x/w))<1&&Vt(j)>=Vt(h)*Zt?d/w:j/h)*w/d<0&&Vt(v=d/w)>2*Vt(t)&&(v=2*(v<0?-1:1)*Vt(t))),(f=Vt(v/m))>.8&&f<2&&(Vt(v=v>0?(c-n)/2:(c-o)/2)>c&&(v=Xt(v)*c),m=3*v),t=c,(c-=v)<n){if(b=Vt(n)<1&&Vt(c)>1&&Zt/Vt(c)<Vt(n)?1e3:c/n,Vt(b)<1&&(b=1/b),!u&&b>0&&b<3)c=t-(v=.99*(t-n)),u=!0;else if((c=t-(v=(t-n)/2))===n||c===o)break}else if(c>o)if(b=Vt(o)<1&&Vt(c)>1&&Zt/Vt(c)<Vt(o)?1e3:c/o,Vt(b)<1&&(b=1/b),!u&&b>0&&b<3)c=t-(v=.99*(t-o)),u=!0;else if((c=t-(v=(t-o)/2))===n||c===o)break;v>0?o=t:n=t}while(l&&Vt(c*s)<Vt(v));return c}var _t=E,rn=u,tn=A,nn=v,on=[0,0];function en(r,t,n,o){return function(e){var i,f,u,a;a=1-e,on=_t(on,e,r,t,!0,o),u=on[0]-n,i=on[1],o&&(i=-i);0===a&&(a=64*nn);0===e&&(e=64*nn);rn(f=i*(-a*r+(t-2)*e+1))<a*e*tn&&(f/=a*e);o&&(f=-f);0===i&&(i=(o?-1:1)*nn*64);return[u,i,f]}}var fn=r,un=t,an=n,mn=o,sn=e,cn=i,pn=f,ln=u,vn=a,jn=m,bn=s,hn=c,kn=p,dn=l,wn=v,xn=j,gn=b,qn=Lr,yn=Tr,zn=Nt,An=Ut,Bn=$t,Cn=en,Dn=32,En=1e3,Fn=[0,0,0,0,0];function Gn(r,t,n,o){var e,i,f,u,a,m,s,c,p,l,v,j,b,h,k,d,w,x,g,q,y,z,A,B,C,D,E;if(i=!1,0===o)return[1,0];if(0===n)return[0,1];if(1===r){if(1===t)return[n,1-n];j=t,t=r,r=j,j=o,o=n,n=j,i=!0}if(D=0,u=0,m=1,.5===r){if(.5===t)return D=bn(n*xn),D*=D,E=bn(o*xn),[D,E*=E];t>.5&&(j=t,t=r,r=j,j=o,o=n,n=j,i=!i)}if(.5===t&&r>=.5&&1!==n)D=qn(r,n,q={}),E=q.value;else{if(1===t)return n<o?r>1?(D=jn(n,1/r),E=-an(dn(n)/r)):E=1-(D=jn(n,1/r)):(D=vn(mn(-o)/r),E=-an(mn(-o)/r)),i&&(j=E,E=D,D=j),[D,E];if(r+t>5)n>.5&&(j=t,t=r,r=j,j=o,o=n,n=j,i=!i),p=kn(r,t),c=hn(r,t),pn(p)>c-p&&p>5?E=1-(D=yn(r,t,n)):(a=sn(pn(r/(B=r+t))),(f=p/B)>=.2&&f<=.8&&B>=10?E=1-(D=(v=jn(n,1/r))<.0025&&r+t<200?v*jn(r*cn(r,t),1/r):zn(n,B,a)):(r<t&&(j=t,t=r,r=j,j=o,o=n,n=j,i=!i),l=0,t<2&&(l=cn(r,t)),0===l?E=1:D=1-(E=jn(t*o*l,1/t))),E>1e-5&&(E=1-(D=An(r,t,n,o))));else if(r<1&&t<1){if(d=un(g=(1-r)/(2-r-t),r,t)-n,ln(d)/n<3*gn)return i?[1-g,g]:[g,1-g];d<0&&(j=t,t=r,r=j,j=o,o=n,n=j,i=!i,g=1-g),E=1/(1+(x=jn(r*n*cn(r,t),1/r))),(D=x/(1+x))>g&&(D=g),m=g}else r>1&&t>1?(b=(t-1)/(r+t-2),un(g=(r-1)/(r+t-2),r,t)-n<0&&(j=t,t=r,r=j,j=o,o=n,n=j,j=b,b=g,g=j,i=!i),w=dn(n*r*cn(r,t))/r,E=(D=vn(w))<.9?1-D:-an(w),t<r&&D<.2&&(h=r-1,k=t-1,z=r*(y=r*r),A=t*t,Fn[0]=0,Fn[1]=1,Fn[2]=k/h,h*=h,Fn[3]=k*(3*r*t+5*t+y-r-4)/(2*(r+2)*h),h*=r+1,Fn[4]=k*(33*r*A+31*A+8*y*A-30*r*t-47*t+11*y*t+6*z*t+18+4*r-z+y*y-10*y),Fn[4]/=3*(r+3)*(r+2)*h,D=fn(Fn,D)),D>g&&(D=g),m=g):(t<r&&(j=t,t=r,r=j,j=o,o=n,n=j,i=!i),jn(n,1/r)<.5?(0===(D=jn(n*r*cn(r,t),1/r))&&(D=wn),E=1-D):(0===(E=jn(1-jn(n,t*cn(r,t)),1/t))&&(E=wn),D=1-E))}return D>.5&&(j=t,t=r,r=j,j=o,o=n,n=j,j=E,E=D,D=j,i=!i,C=1-u,u=1-m,m=C),0===u&&(i?D<(u=gn)&&(D=u):u=wn,D<u&&(D=u)),e=Dn,D<1e-50&&(r<1||t<1)&&(e*=3,e/=2),s=Cn(r,t,n<o?n:o,n>=o),(D=Bn(s,D,u,m,e,En))===u&&(D=0),i?[1-D,D]:[D,1-D]}var Hn=Gn;export default Hn;
//# sourceMappingURL=kernel-betaincinv.js.map